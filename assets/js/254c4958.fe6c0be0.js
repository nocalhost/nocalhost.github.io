"use strict";(self.webpackChunknh_docs=self.webpackChunknh_docs||[]).push([[5797],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return f}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),f=o,h=p["".concat(s,".").concat(f)]||p[f]||d[f]||i;return n?r.createElement(h,a(a({ref:t},c),{},{components:n})):r.createElement(h,a({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},13919:function(e,t,n){function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return o}})},44996:function(e,t,n){n.d(t,{C:function(){return i},Z:function(){return a}});var r=n(52263),o=n(13919);function i(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var i=void 0===r?{}:r,a=i.forcePrependBaseUrl,l=void 0!==a&&a,s=i.absolute,u=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,o.b)(n))return n;if(l)return t+n;var c=n.startsWith(t)?n:t+n.replace(/^\//,"");return u?e+c:c}(i,n,e,t)}}}function a(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},58215:function(e,t,n){var r=n(67294);t.Z=function(e){var t=e.children,n=e.hidden,o=e.className;return r.createElement("div",{role:"tabpanel",hidden:n,className:o},t)}},41395:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(67294),o=n(80944),i=n(86010),a="tabItem_1uMI",l="tabItemActive_2DSg";var s=37,u=39;var c=function(e){var t=e.lazy,n=e.block,c=e.defaultValue,d=e.values,p=e.groupId,f=e.className,h=(0,o.Z)(),v=h.tabGroupChoices,m=h.setTabGroupChoices,b=(0,r.useState)(c),w=b[0],k=b[1],y=r.Children.toArray(e.children),g=[];if(null!=p){var M=v[p];null!=M&&M!==w&&d.some((function(e){return e.value===M}))&&k(M)}var D=function(e){var t=e.currentTarget,n=g.indexOf(t),r=d[n].value;k(r),null!=p&&(m(p,r),setTimeout((function(){var e,n,r,o,i,a,s,u;(e=t.getBoundingClientRect(),n=e.top,r=e.left,o=e.bottom,i=e.right,a=window,s=a.innerHeight,u=a.innerWidth,n>=0&&i<=u&&o<=s&&r>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l),setTimeout((function(){return t.classList.remove(l)}),2e3))}),150))},C=function(e){var t,n;switch(e.keyCode){case u:var r=g.indexOf(e.target)+1;n=g[r]||g[0];break;case s:var o=g.indexOf(e.target)-1;n=g[o]||g[g.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},f)},d.map((function(e){var t=e.value,n=e.label;return r.createElement("li",{role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,className:(0,i.Z)("tabs__item",a,{"tabs__item--active":w===t}),key:t,ref:function(e){return g.push(e)},onKeyDown:C,onFocus:D,onClick:D},n)}))),t?(0,r.cloneElement)(y.filter((function(e){return e.props.value===w}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},y.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})}))))}},79443:function(e,t,n){var r=(0,n(67294).createContext)(void 0);t.Z=r},80944:function(e,t,n){var r=n(67294),o=n(79443);t.Z=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},58763:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u},default:function(){return d}});var r=n(22122),o=n(19756),i=(n(67294),n(3905)),a=(n(41395),n(58215),n(44996),["components"]),l={title:"DevMode Mesh"},s={unversionedId:"guides/develop-service-dup-mesh",id:"guides/develop-service-dup-mesh",isDocsHomePage:!1,title:"DevMode Mesh",description:"Why Mesh DevMode",source:"@site/docs/guides/develop-service-dup-mesh.md",sourceDirName:"guides",slug:"/guides/develop-service-dup-mesh",permalink:"/docs/guides/develop-service-dup-mesh",editUrl:"https://github.com/nocalhost/nocalhost.github.io/tree/main/docs/guides/develop-service-dup-mesh.md",version:"current",lastUpdatedBy:"p_caiwfeng",lastUpdatedAt:1650268926,formattedLastUpdatedAt:"4/18/2022",frontMatter:{title:"DevMode Mesh"},sidebar:"docs",previous:{title:"VPN proxy",permalink:"/docs/guides/develop-service-vpn"},next:{title:"Overview",permalink:"/docs/guides/debug/overview"}},u=[{value:"<strong>Why Mesh DevMode</strong>",id:"why-mesh-devmode",children:[]},{value:"How it works",id:"how-it-works",children:[]},{value:"How to use",id:"how-to-use",children:[]},{value:"FAQ",id:"faq",children:[]}],c={toc:u};function d(e){var t=e.components,l=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"why-mesh-devmode"},(0,i.kt)("strong",{parentName:"h3"},"Why Mesh DevMode")),(0,i.kt)("p",null,"Consider of multiple user may want to develop one service at the same time, but if using DevMode Duplicate, it will not\nreceive traffic, if using DevMode Replace, it can only dev by one user, so we create another DevMode called Mesh\nDevMode, use special headers will route to your DevMode pod, other traffic will route to original pod."),(0,i.kt)("h3",{id:"how-it-works"},"How it works"),(0,i.kt)("p",null,"Use envoy to route traffic with headers, we make a control-plane to distribute route rule."),(0,i.kt)("p",null,"Like the picture below:"),(0,i.kt)("p",null,"Service A is original, receive inbound traffic"),(0,i.kt)("p",null,"Service A' is created by one user enter mesh devMode with special header ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: a=1")),(0,i.kt)("p",null,"Service A'' is created by another user enter mesh devMode with special header ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: a=2")),(0,i.kt)("p",null,"Traffic with header ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: a=1")," will route to Service A'"),(0,i.kt)("p",null,"Traffic with header ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: a=2")," will route to Service A''"),(0,i.kt)("p",null,"Otherwise, traffic will other header, like ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: b=1")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"Header: c=2")," or without header, will handle by Service A"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:n(92103).Z})),(0,i.kt)("h3",{id:"how-to-use"},"How to use"),(0,i.kt)("p",null,"Right-click ",(0,i.kt)("inlineCode",{parentName:"p"},"Start Mesh(Duplicate)")," on the Jetbrains and VS Code extension to enter  ",(0,i.kt)("inlineCode",{parentName:"p"},"Mesh DevMode"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:n(39637).Z})),(0,i.kt)("p",null,"Then, you need to set a header to indicate traffic with this header will route to this pod.\n",(0,i.kt)("img",{alt:"image",src:n(10515).Z})),(0,i.kt)("p",null,"Enter  ",(0,i.kt)("inlineCode",{parentName:"p"},"Mesh DevMode")," and you will see the corresponding icon of the workload, indicating that the workload is\nin ",(0,i.kt)("inlineCode",{parentName:"p"},"Mesh DevMode"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:n(6090).Z})),(0,i.kt)("h3",{id:"faq"},"FAQ"),(0,i.kt)("h4",{id:"do-we-need-to-install-istio-to-use-mesh-devmode"},"Do we need to install istio to use Mesh DevMode?"),(0,i.kt)("p",null,"No, Mesh DevMode use envoy as data-plane, not depends on istio."),(0,i.kt)("h4",{id:"whats-the-difference-between-duplicate-devmode-replace-devmode-and-mesh-devmode"},"What's the difference between ",(0,i.kt)("inlineCode",{parentName:"h4"},"Duplicate DevMode")," ",(0,i.kt)("inlineCode",{parentName:"h4"},"Replace DevMode")," and ",(0,i.kt)("inlineCode",{parentName:"h4"},"Mesh DevMode"),"?"),(0,i.kt)("h4",{id:"does-mesh-devmode-support-all-protocol"},"Does ",(0,i.kt)("inlineCode",{parentName:"h4"},"Mesh DevMode")," support all protocol?"),(0,i.kt)("p",null,"No, it just supports HTTP/GRPC."),(0,i.kt)("h4",{id:"is-there-a-limitation-on-the-number-of-duplicates"},"Is there a limitation on the number of duplicates?"),(0,i.kt)("p",null,"There is no limitation on the number of duplicates in Nocalhost. Theoretically, ",(0,i.kt)("inlineCode",{parentName:"p"},"Mesh DevMode"),"  can be run on any number\nof devices to create their own duplicates for development. However, it may be limited by cluster resources in real\nscenarios."),(0,i.kt)("h4",{id:"how-to-verify-mesh-devmode-works-fine"},"How to verify Mesh DevMode works fine?"),(0,i.kt)("p",null,"You can not use port-forward to verify Mesh devMode, because of localhost traffic will route to local, you can use two\nways to verify it:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"enter another pod terminal, use command line ",(0,i.kt)("inlineCode",{parentName:"li"},"curl")," to send request to origin pod with special header to verify Mesh\nDevMode."),(0,i.kt)("li",{parentName:"ul"},"port-forward service to local, access this service with special header to verify Mesh DevMode.")))}d.isMDXComponent=!0},86010:function(e,t,n){function r(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:function(){return o}})},92103:function(e,t,n){t.Z=n.p+"assets/images/arch-mesh-1f04374e31fbab6be6cc1b6a3857496b.png"},39637:function(e,t,n){t.Z=n.p+"assets/images/button-mesh-86849c48f5b5d00ab438599a75b9dd1d.png"},10515:function(e,t,n){t.Z=n.p+"assets/images/header-mesh-1ab23f2fec74b5e8afd44914ec22a919.png"},6090:function(e,t,n){t.Z=n.p+"assets/images/in-mesh-e0a870fd87798d2cb3e4e2255e8acfd3.png"}}]);